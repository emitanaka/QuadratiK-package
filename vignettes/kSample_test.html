<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>k-sample test</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">k-sample test</h1>



<p>The quadratic distance between two probability distributions <span class="math inline">\(F\)</span> and <span class="math inline">\(G\)</span> is defined as:</p>
<p><span class="math display">\[
d_{K}(F,G) = \int\int K(x,y) d(F-G)(x) d(F-G)(y),
\]</span></p>
<p>where <span class="math inline">\(G\)</span> is a distribution whose
goodness of fit we wish to assess, and <span class="math inline">\(K\)</span> denotes the Normal kernel defined
as:</p>
<p><span class="math display">\[
K(\mathbf{s}, \mathbf{t}) = (2 \pi)^{-d/2}
\left(\det{\mathbf{\Sigma}_h}\right)^{-\frac{1}{2}}  
\exp\left\{-\frac{1}{2}(\mathbf{s} - \mathbf{t})^\top
\mathbf{\Sigma}_h^{-1}(\mathbf{s} - \mathbf{t})\right\},
\]</span></p>
<p>for every <span class="math inline">\(\mathbf{s}, \mathbf{t} \in
\mathbb{R}^d \times \mathbb{R}^d\)</span>, with covariance matrix <span class="math inline">\(\mathbf{\Sigma}_h = h^2 I\)</span> and tuning
parameter.</p>
<p>Consider <span class="math inline">\(k\)</span> random samples of
i.i.d. observations <span class="math inline">\(\mathbf{x}^{(i)}_1,
\mathbf{x}^{(i)}_{2}, \ldots, \mathbf{x}^{(i)}_{n_i} \sim F_i\)</span>,
for <span class="math inline">\(i = 1, \ldots, k\)</span>.</p>
<p>We test if the samples are generated from the same distribution, that
is: <span class="math display">\[
H_0: F_1 = F_2 = \ldots = F_k
\]</span> versus <span class="math display">\[
H_1: F_i \not = F_j,
\]</span> for some <span class="math inline">\(1 \le i \not = j \le
k\)</span>.</p>
<p>We generated three samples, with <span class="math inline">\(n=50\)</span> observations each, from a
2-dimensional Gaussian distributions with mean vectors <span class="math inline">\(\mu_1 = (0, \frac{\sqrt{3}}{3})\)</span>, <span class="math inline">\({\mu}_2 = (-\frac{1}{2},
-\frac{\sqrt{3}}{6})\)</span> and <span class="math inline">\(\mu_3 =
(\frac{1}{2}, -\frac{\sqrt{3}}{6})\)</span>, and the Identity matrix as
covariance matrix. In this situation, the generated samples are well
separated, following different Gaussian distributions, i.e.Â <span class="math inline">\(X_1 \sim N_2(\mu_1, I)\)</span>, <span class="math inline">\(X_2 \sim N_2(\mu_2, I)\)</span> and <span class="math inline">\(X_3 \sim N_2(\mu_3, I)\)</span>}. In order to
perform the <span class="math inline">\(k\)</span>-sample tests, we need
to define the vector <code>y</code> which indicates the membership to
groups.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(QuadratiK)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">3</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2468</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(sizes[<span class="dv">1</span>], <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">*</span>eps<span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(sizes[<span class="dv">2</span>], <span class="at">mean =</span> <span class="fu">c</span>(<span class="sc">-</span>eps<span class="sc">/</span><span class="dv">2</span>,<span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">*</span>eps<span class="sc">/</span><span class="dv">6</span>))</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(sizes[<span class="dv">3</span>], <span class="at">mean =</span> <span class="fu">c</span>(eps<span class="sc">/</span><span class="dv">2</span>,<span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">*</span>eps<span class="sc">/</span><span class="dv">6</span>))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1, x2, x3)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">times=</span>sizes))</span></code></pre></div>
<p>To use the <code>kb.test()</code> function, we need to provide the
value for the tuning parameter <span class="math inline">\(h\)</span>.
The function <code>select_h</code> can be used for identifying on
<em>optimal</em> value of <span class="math inline">\(h\)</span>. This
function needs the input <code>x</code> and <code>y</code> as the
function <code>kb.test</code>, and the selection of the family of
alternatives. Here we consider the location alternatives.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2468</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>h_k <span class="ot">&lt;-</span> <span class="fu">select_h</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">alternative=</span><span class="st">&quot;location&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>h_k<span class="sc">$</span>h_sel</span></code></pre></div>
<pre><code>## [1] 1.2</code></pre>
<p>The <code>select_h</code> function has also generated a figure
displaying the obtained power versus the considered <span class="math inline">\(h\)</span>, for each value of skewness alternative
<span class="math inline">\(\delta\)</span> considered.</p>
<p>We can now perform the <span class="math inline">\(k\)</span>-sample
tests with the <em>optimal</em> value of <span class="math inline">\(h\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2468</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>k_test <span class="ot">&lt;-</span> <span class="fu">kb.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">h=</span>h_k<span class="sc">$</span>h_sel)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">show</span>(k_test)</span></code></pre></div>
<pre><code>## 
##  Kernel-based quadratic distance k-sample test 
## U-statistics  Dn          Trace 
## ------------------------------------------------
## Test Statistic:   3.76127     5.552056 
## Critical Value:   1.270525    1.876836 
## H0 is rejected:   TRUE        TRUE 
## CV method:  subsampling 
## Selected tuning parameter h:  1.2</code></pre>
<p>The function returns an object of class . The method for the object
shows the computed statistics with corresponding critical values, and
the logical indicating if the null hypothesis is rejected. The test
correctly rejects the null hypothesis, in fact the values of the
statistics are greater than the computed critical values. The package
provides also the <code>summary</code> method which returns the results
of the tests together with the standard descriptive statistics for each
variable computed, overall, and with respect to the provided groups.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>summary_ktest <span class="ot">&lt;-</span> <span class="fu">summary</span>(k_test)</span></code></pre></div>
<pre><code>## 
##  Kernel-based quadratic distance k-sample test 
##   Statistic Test_Statistic Critical_Value Reject_H0
## 1        Dn       3.761270       1.270525      TRUE
## 2     Trace       5.552056       1.876836      TRUE</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>summary_ktest<span class="sc">$</span>summary_tables</span></code></pre></div>
<pre><code>## [[1]]
##            Group 1    Group 2    Group 3      Overall
## mean   -0.05208816 -0.3961768  0.5318161  0.027850399
## sd      0.96223294  0.8169982  1.1147943  1.039422979
## median -0.07433374 -0.4171737  0.4466713  0.003313025
## IQR     1.34379740  1.1499518  1.4976634  1.507024820
## min    -2.86000669 -2.1929616 -2.1754778 -2.860006689
## max     1.88750642  1.0851059  2.6517848  2.651784802
## 
## [[2]]
##           Group 1    Group 2    Group 3     Overall
## mean    0.3928294 -0.2851004 -0.4028292 -0.09836674
## sd      0.9612003  1.1243216  0.9603282  1.07079458
## median  0.2303015 -0.1667130 -0.3676814 -0.14246592
## IQR     1.1269249  1.2443774  1.3256384  1.24637078
## min    -1.1662595 -3.5108957 -2.6488286 -3.51089574
## max     3.0792766  2.1192756  1.5225887  3.07927659</code></pre>
<div id="note" class="section level4">
<h4>Note</h4>
<p>If a value of <span class="math inline">\(h\)</span> is not provided
to the , this function performs the function <code>select_h</code> for
automatic search of an <em>optimal</em> value of <span class="math inline">\(h\)</span> to use. . The following code shows its
usage, but it is not executed since we would obtain the same
results.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>k_test_h <span class="ot">&lt;-</span> <span class="fu">kb.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Markatou Marianthi &amp; Saraceno Giovanni (2024). âA Unified
Framework for Multivariate Two- and k-Sample Kernel-based Quadratic
Distance Goodness-of-Fit Tests.â<br />
<a href="https://doi.org/10.48550/arXiv.2407.16374">https://doi.org/10.48550/arXiv.2407.16374</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
